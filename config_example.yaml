# LaserResist Configuration File
# All settings are optional - defaults will be used if not specified

# Gerber file selection (for folder auto-detection)
side: "front"              # PCB side: "front"/"top" (default) or "back"/"bottom"

# Fill generation
line_spacing: 0.1          # Spacing between fill lines in mm
initial_offset: 0.05       # Initial inward offset of outer boundaries to compensate for laser dot size in mm
forced_pad_centerlines: false  # Add centerlines to all pads (+ for rectangular, circles for round)
offset_centerlines: false  # Offset trace centerlines from ends
force_trace_centerlines: false  # Force all trace centerlines without clipping to avoid filled zones
force_trace_centerlines_max_thickness: 0.0  # Max thickness for forced centerlines: 0=all traces, >0=only traces <= thickness (mm)

# Isolated feature compensation (for uneven blooming)
double_expose_isolated: false  # Enable double exposure for isolated features (compensates for less blooming in sparse areas)
isolation_threshold: 3.0       # Distance in mm - features with no copper within this radius are "isolated"

# Laser settings
laser_power: 6.0           # Laser power percentage (0-100)
feed_rate: 1400.0          # Feed rate for exposure in mm/min
travel_rate: 6000.0        # Rapid travel rate in mm/min
z_height: 20.0             # Z height for laser focus in mm

# Coordinate transformation
x_offset: 0.0              # X offset in mm
y_offset: 0.0              # Y offset in mm
# normalize_origin: true   # Normalize coordinates (handled by --no-normalize CLI flag)
flip_horizontal: false     # Flip board horizontally (mirror X axis) - use true for bottom layer

# Bed mesh calibration (optional)
bed_mesh: true             # Enable bed mesh calibration
mesh_offset: 3.0           # Offset from board edges in mm
probe_count: "3,3"         # Probe points (X,Y)

# Laser control commands (optional)
laser_arm_command: "ARM_LASER"       # Command to enable laser relay
laser_disarm_command: "DISARM_LASER" # Command to disable laser relay

# Board outline drawing (optional)
draw_outline: false                  # Draw board outline before exposure (for positioning)
outline_offset_count: 0              # Offset copies: 0=single, -1=one outward, +1=one inward, etc.
                                     # NOTE: Negative (outward) requires x_offset/y_offset >= abs(count) * line_spacing
                                     # Positive (inward) for boards with space between outline and copper
                                     # Negative (outward) shifts effective board position - use with care!

# Pin alignment mode (optional, requires --pin-mode)
# pin_macro: true     # Use SETUP_PCB_SPACE macro for alignment (requires macro on printer)
#                     # If false/not set, uses software-based coordinate transformation

# Drilling template generation (requires --pin-mode)
generate_template_stl: false         # Generate 3D-printable drilling template STL
# stl_name: "template.stl"           # Custom STL filename (default: same as gcode with .stl)
template_block_height: 4.0           # Height of template block in mm
template_wall_thickness: 2.0         # Thickness of alignment walls in mm
hole_print_tolerance: 0.2            # Extra diameter for 3D print compensation in mm
pcb_safety_offset: 0.0               # Extra margin around board in mm (makes template bigger on all sides)

# Bloom compensation (experimental - trace-based ambient exposure analysis)
bloom_compensation: false      # Enable bloom compensation for under-exposed traces
bloom_resolution: 0.05         # Simulation grid resolution in mm (smaller = more accurate but slower)
bloom_spot_sigma: 0.05         # Tight laser spot Gaussian sigma in mm
bloom_scatter_sigma: 2.0       # Bloom scatter Gaussian sigma in mm (tune based on your laser/resist)
bloom_scatter_fraction: 0.35   # Fraction of energy in scatter vs tight spot (0-1, typically 0.2-0.5)
bloom_threshold_percentile: 30 # Percentile threshold for detection (lower = fewer traces marked as under-exposed)
bloom_debug_image: false       # Generate bloom visualization PNG alongside G-code file
